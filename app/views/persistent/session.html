<div class="wrapper">

    {menu}

    <section class="content {%!if isLoggedIn}no-left{%/!if}">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">
                    <div class="view-header">
                        <div class="header-title">
                            <h3 class="m-b-xs">Persistent session</h3>
                            <small>The session page allows you to manage, proxy, and delete your session. Also holds all
                                the information like URL, cookies, HTML DOM and more.
                            </small>
                        </div>
                    </div>
                    <hr>
                </div>
            </div>

            {message}

            <div class="row">
                <div class="col-lg-6">
                    <div class="panel panel-filled">
                        <div class="panel-heading">Session data</div>
                        <div class="panel-body">
                            <table class="table report-table">
                                <tbody>
                                    <tr class="report-row">
                                        <td class="field-name">
                                            <strong>Client ID</strong>
                                        </td>
                                        <td class="field-content">
                                            <code class="origin-display">{%data clientid}</code>
                                        </td>
                                    </tr>
                                    <tr class="report-row">
                                        <td class="field-name">
                                            <strong>Browser</strong>
                                        </td>
                                        <td class="field-content">
                                            <span class="browser-display">{%data browser}</span>
                                        </td>
                                    </tr>
                                    <tr class="report-row highlight-row">
                                        <td class="field-name">
                                            <strong>Payload</strong>
                                        </td>
                                        <td class="field-content">
                                            <span class="badge badge-danger payload-badge">{%data payload}</span>
                                        </td>
                                    </tr>
                                    <tr class="report-row">
                                        <td class="field-name">
                                            <strong>Origin</strong>
                                        </td>
                                        <td class="field-content">
                                            <code class="origin-display">{%data origin}</code>
                                        </td>
                                    </tr>
                                    <tr class="report-row timestamp-row">
                                        <td class="field-name">
                                            <strong>Status</strong>
                                        </td>
                                        <td class="field-content">
                                            <span class="timestamp-display">
                                                
                                                <time class="time-formatted"><a href="/manage/persistent/requests/{%data link}" class="requests-link">{%data requests}</a> requests, last ping {%data last}</time>
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="panel panel-filled">
                        <div class="panel-heading">Settings</div>
                        <div class="panel-body">
                            <form class="form" method="post">
                                <input type=hidden hidden name="csrf" value="{session[csrfToken]}">
                                <div class="form-group">
                                    <label class="control-label" for="ipport">Reverse proxy</label>
                                    <input class="form-control" name="ipport" id="ipport" type="text"
                                            placeholder="{domain[]}:30055">
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="form-group">
                                            <label class="checkbox-label">
                                                <input checked class="chkbox" name="passorigin" type="checkbox">
                                                <span class="checkbox-custom rectangular"></span>
                                            </label>
                                            <p class="checkbox-text">Pass origin requests</p>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="form-group">
                                            <label class="checkbox-label">
                                                <input class="chkbox" name="autoreconnect" type="checkbox">
                                                <span class="checkbox-custom rectangular"></span>
                                            </label>
                                            <p class="checkbox-text">Auto reconnect</p>
                                        </div>
                                    </div>
                                </div>
                                <button name="proxy" type="submit" class="btn">Start</button>
                            </form>

                            <hr style="border-top:2px solid #64698f">

                            <label class="section-title">Session management</label>
                            <form class="form" method="post">
                                <input type=hidden hidden name="csrf" value="{session[csrfToken]}">
                                <button name="delete" type="submit" class="btn">Delete</button>
                                <button name="archive" type="submit" class="btn">Archive</button>
                                <button name="kill" type="submit" class="btn">Kill persistent</button>
                                <button name="killreconnect" type="submit" class="btn">Kill reconnect</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-filled">
                        <div class="panel-heading">Console</div>
                        <div class="panel-body">
                            <div class="form-group">
                                <label class="control-label" for="console">Output</label>
                                <textarea class="form-control modern-textarea console-output" name="console" id="console"
                                    rows="5" readonly>{%data console}</textarea>
                            </div>

                            <div class="form-group">
                                <label class="control-label" for="command">Execute</label>
                                <div class="data-container">
                                    <textarea type="text" name="command" id="command" placeholder="console.log('Hello from ezXSS');"
                                        class="form-control modern-textarea" rows="2"></textarea>
                                    <button class="btn execute-btn" id="execute">
                                        Execute
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-12">
                    <div class="panel panel-filled">
                        <div class="panel-heading">Last request</div>
                        <div class="panel-body">
                            <table class="table report-table">
                                <tbody>
                                    <tr class="report-row">
                                        <td class="field-name">
                                            <strong>URL</strong>
                                        </td>
                                        <td class="field-content">
                                            <code class="url-display">{%data uri}</code>
                                        </td>
                                    </tr>
                                    <tr class="report-row">
                                        <td class="field-name">
                                            <strong>IP</strong>
                                        </td>
                                        <td class="field-content">
                                            <span class="ip-display">{%data ip}</span>
                                        </td>
                                    </tr>
                                    <tr class="report-row">
                                        <td class="field-name">
                                            <strong>Referer</strong>
                                        </td>
                                        <td class="field-content">
                                            <code class="referer-display">{%data referer}</code>
                                        </td>
                                    </tr>
                                    <tr class="report-row">
                                        <td class="field-name">
                                            <strong>User Agent</strong>
                                        </td>
                                        <td class="field-content">
                                            <small class="user-agent-display">{%data user-agent}</small>
                                        </td>
                                    </tr>
                                    <tr class="report-row expandable-row">
                                        <td class="field-name">
                                            <strong>Cookies</strong>
                                        </td>
                                        <td class="field-content">
                                            <div class="data-container">
                                                <textarea spellcheck="false" class="form-control modern-textarea" 
                                                          rows="4" id="cookies" readonly>{%data cookies}</textarea>
                                                <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="#cookies">
                                                    Copy
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="report-row expandable-row">
                                        <td class="field-name">
                                            <strong>Local Storage</strong>
                                        </td>
                                        <td class="field-content">
                                            <div class="data-container">
                                                <textarea spellcheck="false" class="form-control modern-textarea" 
                                                          rows="4" id="localstorage" readonly>{%data localstorage}</textarea>
                                                <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="#localstorage">
                                                    Copy
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="report-row expandable-row">
                                        <td class="field-name">
                                            <strong>Session Storage</strong>
                                        </td>
                                        <td class="field-content">
                                            <div class="data-container">
                                                <textarea spellcheck="false" class="form-control modern-textarea" 
                                                          rows="4" id="sessionstorage" readonly>{%data sessionstorage}</textarea>
                                                <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="#sessionstorage">
                                                    Copy
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="report-row expandable-row">
                                        <td class="field-name">
                                            <strong>DOM</strong>
                                        </td>
                                        <td class="field-content">
                                            <div class="data-container">
                                                <textarea spellcheck="false" class="form-control modern-textarea dom-textarea" 
                                                          rows="12" id="dom" readonly>{%data dom}</textarea>
                                                <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="#dom">
                                                    Copy
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="report-row timestamp-row">
                                        <td class="field-name">
                                            <strong>Time</strong>
                                        </td>
                                        <td class="field-content">
                                            <span class="timestamp-display">
                                                <time class="time-formatted">{%data time}</time>
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>